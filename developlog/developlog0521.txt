개발 9일차
기어코 몸살에 걸렸다. 약하긴 하지만 몸에 기운이 빠지고 목도 아프다. 어제 먹은 만두가 좀 매웠는지 배도 아프다.
환절기 감기 조심해야하는데 잡설은 여기까지 하고 오늘 할일을 정리해보겠다. 할려고 하니깐 힘빠져서 기운이 안난다.
좀 쉬거든 할런다. 파일 시스템 구축할려니 머리가 아플 지경이다. 테이블 account와 profile은 1:1 관계이다. 그리고
profile과 file은 1:1이다 profile의 avatar 파일 하나만 연결 시키기 때문이다. 하지만 file은 다른 테이블과 
다대다 관계가 될 수 있다. 일단은 profile이 생성되면 file 하나를 생성시켜 사용해야겠다. 하다보니깐 의문이 들어 다시 생각해보니
어차피 avatar로 쓸 파일로 유저에 할당된 파일로 생각해야하는 것 아닌가 생각이 든다. 도대체 어떻게 해야 되는 것인가 
머리가 안돌아간다. 유저와 파일이 일대다 관계라면 유저는 파일을 어떤 것을 기준으로 구별해야 하는가 구별점이 필요하다.
새로운 속성을 넣고 구분하기로 하였다. 그리고 파일 테이블과 관계를 설정할때 항상 다대다로 관계를 위한 테이블을 새로 만들기로 하였다.
다음 front 쪽을 작업하고 있는데 내가 jwt를 건네주는데도 email을 일일이 보내 유저를 조회 확인하는 작업이 이상하다고 생각해
alpha 프로젝트를 보기로 하였다. 필터에서 jwt를 부호화 하여 아이디를 확인하는 작업을 한다. 하지만 이 과정에서 계정 정보를
밖으로 빼면 보안상 문제가 생기는 것인가? 그런가 보다 alpha 프로젝트도 요청자 확인을 위해 username을 받는다. 
아 젠장 구별점을 잘못 생각한 것 같다. 내가 너무 복잡하게 생각하는건가? 구상해놓은게 맘에 안들어서 다시 뒤업고 있다.
다시 또 생각해야되. 그냥 하던 방식을 쓰기로 했다. 자 생각해보자. file에 description을 넣어 description이 profile인것을 찾아
쓰는 방법과 profile안에 avatar로 쓸 file_id를 쓰는 방법을 비교해 보자. file의 관계는 다대다로 유지할 생각이다.
하지만 profile안에 file_id를 쓰는 것은 file 간 관계가 일대일이 되니 이 방법은 안될 것이다. 아닌가 다대다 관계는 굳이 profile까지
고집할 필요는 없는가? file과 email String을 같이 넣어 보냈더니 오류가 난다. post로 타입이 다른 두 파라미터를 같이 보내는 것은
좋지 않은 방법인것 같다. vue에서도 file 객체를 어떻게 보내야 하는지 잘 모르겠다. Required request part 'file' is not present
왜 이런것이 뜰까? 난 분명이 file을 보냈는데 말이다. 이제 file, email 파라미터를 모두 받는다. 하지만 service 도중에
account에 profile이 있지만 profile에 file_id에 맞는 file이 없어서 null point error가 발생한다. 아 돌겠다. 고치면 고칠수록
해결이 안된채 복잡해지고 있다. 엉킨 실을 풀려고 하다가 더 엉켜버린 기분이다. @onetoone을 이해하려다 망쳐버린것 같다. 
후자가 안됬으니 이제 전자를 시도해 보자. 계정과 파일을 다대다 관계로 만들고 속성하나를 추가해 아바타 파일에 대한 구분으로 
쓸 것이다. 프로파일과 파일 관계도 다대다로 설정하자. 다대다가 아닌 관계인 일대일 관계는 객체 나 튜플 생성 시 외래키가 비어 있으면
에러가 발생한다. 좋은 방법이 어디 없을까? CascadeType에 답이 있을 것 같다. 좀 더 알아보자.
처음 계정 생성 후 프로파일 저장 할 때에는 불러올 수 있는 프로파일이 없기 때문에 null 에러가 발생한다.
망할 정리 하자. 프로파일 저장 할 때 에러 해결, 저장 후 아바타 파일 업로드 구현, 다운로드 구현, URL로 아바타 불러오기 구현
내일 프로파일 마무리 해보자